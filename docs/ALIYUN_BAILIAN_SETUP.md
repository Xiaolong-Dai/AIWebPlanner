# ğŸš€ é˜¿é‡Œäº‘ç™¾ç‚¼é…ç½®æŒ‡å—

ç”±äºé˜¿é‡Œäº‘ç™¾ç‚¼APIä¸æ”¯æŒæµè§ˆå™¨ç›´æ¥è°ƒç”¨ï¼ˆCORSé™åˆ¶ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ã€‚

---

## ğŸ“‹ æ–¹æ¡ˆé€‰æ‹©

### æ–¹æ¡ˆA: æœ¬åœ°å¼€å‘ + Verceléƒ¨ç½²ï¼ˆæ¨èï¼‰

- âœ… æœ¬åœ°å¼€å‘ä½¿ç”¨æœ¬åœ°ä»£ç†
- âœ… ç”Ÿäº§ç¯å¢ƒä½¿ç”¨Vercel Serverless Function
- âœ… å®Œå…¨å…è´¹
- âœ… é…ç½®ç®€å•

### æ–¹æ¡ˆB: ä»…æœ¬åœ°å¼€å‘

- âœ… åªåœ¨æœ¬åœ°è¿è¡Œ
- âœ… ä¸éœ€è¦éƒ¨ç½²
- âš ï¸ æ— æ³•åœ¨çº¿è®¿é—®

---

## ğŸ”§ æ–¹æ¡ˆA: å®Œæ•´é…ç½®ï¼ˆæ¨èï¼‰

### ç¬¬ä¸€æ­¥: æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®

#### 1. å®‰è£…ä¾èµ–

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ:

```bash
npm install express cors
```

#### 2. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰“å¼€**æ–°çš„ç»ˆç«¯çª—å£**ï¼Œè¿è¡Œ:

```bash
node proxy-server.js
```

ä½ åº”è¯¥çœ‹åˆ°:
```
ğŸš€ ä»£ç†æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3001
ğŸ“¡ ä»£ç†ç«¯ç‚¹: http://localhost:3001/api/llm-proxy
ğŸ’š å¥åº·æ£€æŸ¥: http://localhost:3001/health
```

**ä¿æŒè¿™ä¸ªç»ˆç«¯çª—å£è¿è¡Œï¼**

#### 3. å¯åŠ¨å‰ç«¯åº”ç”¨

åœ¨**å¦ä¸€ä¸ªç»ˆç«¯çª—å£**ï¼Œè¿è¡Œ:

```bash
cd frontend
npm run dev
```

#### 4. é…ç½®é˜¿é‡Œäº‘ç™¾ç‚¼

1. æ‰“å¼€æµè§ˆå™¨: http://localhost:5173
2. è¿›å…¥ **è®¾ç½®é¡µé¢**
3. é…ç½®AIæœåŠ¡:
   ```
   API Key: ä½ çš„é˜¿é‡Œäº‘ç™¾ç‚¼API Key
   API Endpoint: https://bailian.aliyun.com/v1/api/completions
   ```
4. ç‚¹å‡» **ä¿å­˜é…ç½®**
5. ç‚¹å‡» **æµ‹è¯• AI æœåŠ¡**

#### 5. æµ‹è¯•

1. è¿›å…¥ **åˆ›å»ºè®¡åˆ’** é¡µé¢
2. è¾“å…¥: "æˆ‘æƒ³å»åŒ—äº¬ï¼Œ3å¤©ï¼Œé¢„ç®—5000å…ƒ"
3. ç‚¹å‡»å‘é€
4. åº”è¯¥èƒ½æ­£å¸¸ç”Ÿæˆè¡Œç¨‹äº†ï¼âœ…

---

### ç¬¬äºŒæ­¥: éƒ¨ç½²åˆ°Vercelï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

#### 1. å®‰è£…Vercel CLI

```bash
npm install -g vercel
```

#### 2. ç™»å½•Vercel

```bash
vercel login
```

#### 3. éƒ¨ç½²é¡¹ç›®

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ:

```bash
vercel
```

æŒ‰ç…§æç¤ºæ“ä½œ:
- Set up and deploy? **Y**
- Which scope? é€‰æ‹©ä½ çš„è´¦å·
- Link to existing project? **N**
- Project name? **ai-web-planner** (æˆ–å…¶ä»–åç§°)
- In which directory is your code located? **./** (å½“å‰ç›®å½•)

#### 4. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ æƒ³åœ¨Vercelä¸­å­˜å‚¨API Key:

```bash
vercel env add ALIYUN_API_KEY
```

è¾“å…¥ä½ çš„é˜¿é‡Œäº‘API Key

#### 5. ç”Ÿäº§éƒ¨ç½²

```bash
vercel --prod
```

éƒ¨ç½²å®Œæˆåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªURLï¼Œä¾‹å¦‚:
```
https://ai-web-planner.vercel.app
```

#### 6. åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨

è®¿é—®ä½ çš„Vercel URLï¼Œåº”ç”¨ä¼šè‡ªåŠ¨ä½¿ç”¨Vercelçš„ä»£ç†ç«¯ç‚¹ `/api/llm-proxy`

---

## ğŸ”§ æ–¹æ¡ˆB: ä»…æœ¬åœ°å¼€å‘

å¦‚æœä½ åªæƒ³åœ¨æœ¬åœ°ä½¿ç”¨ï¼Œåªéœ€è¦:

### 1. å®‰è£…ä¾èµ–

```bash
npm install express cors
```

### 2. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

```bash
node proxy-server.js
```

### 3. å¯åŠ¨å‰ç«¯

```bash
cd frontend
npm run dev
```

### 4. é…ç½®å¹¶ä½¿ç”¨

æŒ‰ç…§æ–¹æ¡ˆAçš„æ­¥éª¤4-5æ“ä½œ

---

## ğŸ“ package.json è„šæœ¬ï¼ˆå¯é€‰ï¼‰

ä¸ºäº†æ–¹ä¾¿ï¼Œå¯ä»¥åœ¨æ ¹ç›®å½•çš„ `package.json` æ·»åŠ è„šæœ¬:

```json
{
  "scripts": {
    "dev": "concurrently \"node proxy-server.js\" \"cd frontend && npm run dev\"",
    "proxy": "node proxy-server.js",
    "frontend": "cd frontend && npm run dev"
  }
}
```

ç„¶åå®‰è£… `concurrently`:

```bash
npm install -D concurrently
```

ä¹‹ååªéœ€è¿è¡Œ:

```bash
npm run dev
```

å°±ä¼šåŒæ—¶å¯åŠ¨ä»£ç†æœåŠ¡å™¨å’Œå‰ç«¯åº”ç”¨ï¼

---

## ğŸ§ª æµ‹è¯•ä»£ç†æœåŠ¡å™¨

### æµ‹è¯•å¥åº·æ£€æŸ¥

```bash
curl http://localhost:3001/health
```

åº”è¯¥è¿”å›:
```json
{"status":"ok","message":"ä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸"}
```

### æµ‹è¯•ä»£ç†ç«¯ç‚¹

```bash
curl -X POST http://localhost:3001/api/llm-proxy \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "ä½ å¥½",
    "apiKey": "ä½ çš„API_Key",
    "endpoint": "https://bailian.aliyun.com/v1/api/completions"
  }'
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä»£ç†æœåŠ¡å™¨å¯åŠ¨å¤±è´¥

**é”™è¯¯:** `Error: listen EADDRINUSE: address already in use :::3001`

**è§£å†³æ–¹æ¡ˆ:**
```bash
# Windows
netstat -ano | findstr :3001
taskkill /PID <PID> /F

# Mac/Linux
lsof -ti:3001 | xargs kill -9
```

### Q2: å‰ç«¯æ— æ³•è¿æ¥ä»£ç†

**æ£€æŸ¥:**
1. ä»£ç†æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
2. ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆ3001ï¼‰
3. æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### Q3: Verceléƒ¨ç½²åæ— æ³•ä½¿ç”¨

**æ£€æŸ¥:**
1. `vercel.json` é…ç½®æ˜¯å¦æ­£ç¡®
2. `api/llm-proxy.ts` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
3. Vercelæ—¥å¿—ä¸­æ˜¯å¦æœ‰é”™è¯¯

### Q4: ä»ç„¶æœ‰CORSé”™è¯¯

**å¯èƒ½åŸå› :**
1. ä»£ç†æœåŠ¡å™¨æœªå¯åŠ¨
2. å‰ç«¯ä»£ç æœªæ­£ç¡®ä½¿ç”¨ä»£ç†
3. æµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼ˆæ¸…é™¤ç¼“å­˜é‡è¯•ï¼‰

---

## ğŸ¯ å®Œæ•´å·¥ä½œæµç¨‹

### å¼€å‘ç¯å¢ƒ

```bash
# ç»ˆç«¯1: å¯åŠ¨ä»£ç†
node proxy-server.js

# ç»ˆç«¯2: å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# æµè§ˆå™¨è®¿é—®
http://localhost:5173
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# éƒ¨ç½²åˆ°Vercel
vercel --prod

# è®¿é—®ç”Ÿäº§URL
https://your-app.vercel.app
```

---

## ğŸ“Š æ¶æ„è¯´æ˜

### å¼€å‘ç¯å¢ƒ
```
æµè§ˆå™¨ â†’ http://localhost:5173 (å‰ç«¯)
         â†“
         http://localhost:3001/api/llm-proxy (æœ¬åœ°ä»£ç†)
         â†“
         https://bailian.aliyun.com (é˜¿é‡Œäº‘ç™¾ç‚¼)
```

### ç”Ÿäº§ç¯å¢ƒ
```
æµè§ˆå™¨ â†’ https://your-app.vercel.app (å‰ç«¯)
         â†“
         https://your-app.vercel.app/api/llm-proxy (Vercel Function)
         â†“
         https://bailian.aliyun.com (é˜¿é‡Œäº‘ç™¾ç‚¼)
```

---

## âœ… éªŒæ”¶æ¸…å•

- [ ] ä»£ç†æœåŠ¡å™¨æˆåŠŸå¯åŠ¨
- [ ] å‰ç«¯åº”ç”¨æˆåŠŸå¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥è¿”å›æ­£å¸¸
- [ ] è®¾ç½®é¡µé¢é…ç½®æˆåŠŸ
- [ ] AIæœåŠ¡æµ‹è¯•é€šè¿‡
- [ ] èƒ½å¤Ÿç”Ÿæˆæ—…è¡Œè®¡åˆ’
- [ ] Verceléƒ¨ç½²æˆåŠŸï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] ç”Ÿäº§ç¯å¢ƒæ­£å¸¸å·¥ä½œï¼ˆå¦‚éœ€è¦ï¼‰

---

## ğŸ‰ å®Œæˆï¼

å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œä½ å°±å¯ä»¥åœ¨æœ¬åœ°å’Œç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨é˜¿é‡Œäº‘ç™¾ç‚¼äº†ï¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—æˆ–è”ç³»æˆ‘ã€‚ğŸ˜Š

